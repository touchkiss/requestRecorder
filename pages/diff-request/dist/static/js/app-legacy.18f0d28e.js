(function(){"use strict";var e={2205:function(e,t,n){n(6992),n(8674),n(9601),n(7727);var o=n(8935),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("main",{staticClass:"main-container"},[n("div",{staticClass:"top"},[n("div",{staticClass:"header"},[n("h1",[e._v(" diffRequest ")]),n("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#fff000","inactive-color":"#ff4949","inactive-text":e.recording?"正在录制":"不在录制"},on:{change:e.toggleRecorder},model:{value:e.recording,callback:function(t){e.recording=t},expression:"recording"}})],1)]),n("div",{staticClass:"bottom"},[n("div",{staticClass:"right"},[n("el-row",{attrs:{gutter:10}},[n("el-col",{attrs:{span:6}},[n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("transition",{attrs:{name:"el-zoom-in-top"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.allRequest.length,expression:"allRequest.length"}],staticClass:"card-header"},[n("h3",[e._v("Request List"),n("i",{staticClass:"el-icon-refresh",on:{click:e.loadFromChrome}},[e._v("重新导入")])]),n("el-row",[n("el-col",{attrs:{span:24}},[n("el-input",{attrs:{type:"text",placeholder:"输入regex过滤"},model:{value:e.urlRegex,callback:function(t){e.urlRegex=t},expression:"urlRegex"}})],1)],1)],1)]),e.allRequest.length?e._e():n("el-empty",{attrs:{description:"请先录制请求"}}),n("transition",{attrs:{name:"el-zoom-in-top"}},[n("el-table",{directives:[{name:"show",rawName:"v-show",value:e.allRequest.length,expression:"allRequest.length"}],staticStyle:{width:"100%"},attrs:{data:e.filteredRequest,"highlight-current-row":"","max-height":e.screenHeight-260+"px"},on:{"current-change":e.handleCurrentChange,"selection-change":e.handleSelectionRequestsChange}},[n("el-table-column",{attrs:{type:"selection",width:"30"}}),n("el-table-column",{attrs:{label:"url","header-align":"center",prop:"requestUrl"}}),n("el-table-column",{attrs:{prop:"method",label:"method",align:"right",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"复制http请求",placement:"right"}},[n("i",{staticClass:"el-icon-s-order",on:{click:function(n){return e.copyToClipboard(t.row,t.row.host)}}})])]}}])})],1)],1),e.allRequest.length&&e.selectedRequest.length?n("el-row",{staticClass:"mb-4",staticStyle:{"margin-top":"10px"},attrs:{gutter:10}},[n("el-col",{attrs:{span:12,align:"center"}},[n("el-button",{attrs:{type:"danger",round:""},on:{click:e.deleteRequest}},[e._v("删除")])],1),n("el-col",{attrs:{span:12,align:"center"}},[n("el-dropdown",{on:{command:e.exportRequest}},[n("el-button",{attrs:{type:"success",round:""}},[e._v(" 导出"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",[n("el-dropdown-item",{attrs:{command:"http"}},[e._v("http")]),n("el-dropdown-item",{attrs:{command:"postman"}},[e._v("postman")])],1)],1)],1)],1):e._e()],1)],1),n("transition",{attrs:{name:"el-zoom-in-top"}},[n("el-col",{directives:[{name:"show",rawName:"v-show",value:e.allRequest.length,expression:"allRequest.length"}],attrs:{span:18}},[n("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[n("el-row",[n("el-col",{attrs:{span:24}},[n("h3",{attrs:{"text-gray-600":""}},[e._v(" "+e._s(e.curRequest&&e.curRequest.url?e.curRequest.method+":"+e.curRequest.requestUrl:"请在左侧选择要测试的request")+" ")])])],1),n("el-row",{staticClass:"content-row",attrs:{gutter:10}},[n("el-col",{attrs:{span:12}},[n("el-input",{attrs:{type:"text",value:e.curRequest&&e.curRequest.host||"",placeholder:"main host"}})],1),n("el-col",{attrs:{span:12}},[n("el-input",{attrs:{type:"text",placeholder:"compare host"},model:{value:e.compareHost,callback:function(t){e.compareHost=t},expression:"compareHost"}})],1)],1),n("el-row",{staticClass:"content-row"},[n("el-col",{attrs:{span:24,align:"center"}},[n("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[n("el-collapse-item",{attrs:{title:"request headers",name:"1"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.curRequest&&e.curRequest.headers||[],"max-height":"400"}},[n("el-table-column",{attrs:{width:"200",label:"name","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{span:12,type:"text",placeholder:"header name"},model:{value:t.row.name,callback:function(n){e.$set(t.row,"name",n)},expression:"props.row.name"}})]}}])}),n("el-table-column",{attrs:{label:"value","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{attrs:{type:"text",placeholder:"header value"},model:{value:t.row.value,callback:function(n){e.$set(t.row,"value",n)},expression:"props.row.value"}})]}}])})],1)],1),n("el-collapse-item",{attrs:{title:"request body",name:"2"}},[n("el-input",{attrs:{rows:5,type:"textarea",placeholder:"Request Body"},model:{value:e.curRequest.requestBody,callback:function(t){e.$set(e.curRequest,"requestBody",t)},expression:"curRequest.requestBody"}})],1)],1)],1)],1),n("el-row",{staticClass:"content-row"},[n("el-col",{attrs:{span:24,align:"center"}},[e.curRequest&&e.curRequest.url?n("el-button-group",[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"复制main host的http请求体",placement:"top"}},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.copyToClipboard(e.curRequest,e.curRequest.host)}}},[e._v("main ")])],1),n("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.sending,expression:"sending"}],attrs:{type:"danger",round:""},on:{click:function(t){return e.sendAndCompare(void 0,void 0)}}},[e._v(" 发送 ")]),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"复制compare host的http请求体",placement:"top"}},[n("el-button",{attrs:{type:"primary",title:"复制compare host的http请求体"},on:{click:function(t){return e.copyToClipboard(e.curRequest,e.compareHost)}}},[e._v(" comp ")])],1)],1):e._e()],1)],1),n("el-row",{staticClass:"content-row"},[n("el-col",{attrs:{span:24}},[e.finishCompare&&!e.showHttp?n("json-diff",{attrs:{jsonSourceLeft:e.leftData,jsonSourceRight:e.rightData}}):e._e(),e.finishCompare||e.showHttp?e._e():n("el-input",{attrs:{value:JSON.stringify(e.curResponseBody,null,2),rows:20,type:"textarea",placeholder:"Response body"}}),e.showHttp?n("el-input",{attrs:{rows:20,type:"textarea",id:"httpText",placeholder:"Response body"},model:{value:e.httpText,callback:function(t){e.httpText=t},expression:"httpText"}}):e._e()],1)],1)],1)],1)],1)],1)],1)])])])},s=[],a=n(6198),l=n(3019),c=(n(8975),n(7327),n(1539),n(4916),n(4723),n(5306),n(8309),n(4747),n(561),n(2222),n(9600),n(1249),n(8862),n(278)),i=n(6166),u=n.n(i),d=n(4549),p=n.n(d),h=u().create({timeout:2e4});h.defaults.withCredentials=!0,h.interceptors.request.use((function(e){return e}),(function(e){return console.log(e),Promise.reject(e)})),h.interceptors.response.use((function(e){return e}),(function(e){return console.log(e),Promise.reject(e)}));var m=h,f={name:"App",data:function(){return{storedRequests:[],allRequest:[],filteredRequest:[],screenWidth:window.clientWidth,screenHeight:window.innerHeight,selectedRequest:[],curRequest:{},compareHost:localStorage.getItem("compareHost")||"",activeNames:["2"],multipleHeadsersRef:{},headersSelected:[],leftData:{},rightData:{},finishCompare:!1,curResponseBody:{},urlRegex:localStorage.getItem("urlRegex")||/[htps]+:\/\/[\S]*/,recording:!1,updateRecording:"",methodFilter:[{text:"GET",value:"GET"},{text:"POST",value:"POST"},{text:"OPTIONS",value:"OPTIONS"},{text:"PUT",value:"PUT"},{text:"DELETE",value:"DELETE"},{text:"PATCH",value:"PATCH"},{text:"HEAD",value:"HEAD"}],showHttp:!1,httpText:"",sending:!1}},components:{JsonDiff:c["default"]},mounted:function(){var e=this,t=this;window.onresize=function(){return function(){t.screenWidth=window.clientWidth,t.screenHeight=window.innerHeight}()},this.loadFromChrome(),this.updateRecording=setInterval((function(){chrome.runtime.sendMessage({type:"recordingRequest"},(function(t){e.recording=t.recordingRequest}))}),1e3)},beforeUnmount:function(){clearInterval(this.updateRecording)},watch:{urlRegex:function(){var e=this;this.filteredRequest=this.allRequest.filter((function(t){return t.url&&t.url.match(e.urlRegex)})),localStorage.setItem("urlRegex",this.urlRegex)},compareHost:function(){localStorage.setItem("compareHost",this.compareHost)}},methods:{copyToClipboard:function(e,t){var n=this,o=(0,l.Z)({},e);o["host"]=t,o["url"]=t+o["requestUrl"],this.httpText=this.constructHttpFileContent([o]),this.showHttp=!0,setTimeout((function(){var e=document.getElementById("httpText");e.select(),document.execCommand("Copy"),n.$message({message:"已将http请求复制到剪贴板",type:"success"})}),500)},loadFromChrome:function(){var e=this;chrome.runtime.sendMessage({type:"loadAllRequest"},(function(t){e.allRequest=t.requests,t.requests.length?e.$message({message:"已重新加载所有请求",type:"success"}):e.$message({message:"没有记录，请先录制请求",type:"success"}),e.filteredRequest=e.allRequest.filter((function(t){return t.url&&t.url.match(e.urlRegex)}))}))},toggleRecorder:function(){var e=this;chrome.runtime.sendMessage({type:"toggleRecorder"},(function(t){console.log(t),setTimeout((function(){e.recording||e.loadFromChrome()}),1e3)}))},regexUrl:function(e){return e.replace(/[htps]+:\/\/[a-zA-Z0-9-\.]+/g,"")},regexHost:function(e){var t=e.match(/[htps]+:\/\/[a-zA-Z0-9-\.]+/g);return t?t[0]:""},filterMethod:function(e,t,n){return e===t["method"]},handleCurrentChange:function(e){this.curRequest=e||{}},sendAndCompare:function(){var e=arguments,t=this;return(0,a.Z)(regeneratorRuntime.mark((function n(){var o,r,s,a,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=e.length>0&&void 0!==e[0]?e[0]:void 0,r=e.length>1&&void 0!==e[1]?e[1]:void 0,t.sending=!0,t.showHttp=!1,t.finishCompare=!1,s="",console.log(123),a=t.curRequest.headers.filter((function(e){return"Content-Type"===e.name}))[0],s=a?a["value"].match("application/x-www-form-urlencoded")?t.curRequest.requestBody:a["value"].match("application/json")?JSON.parse(t.curRequest.requestBody):t.curRequest.requestBody:"",console.log(s),l={},t.curRequest.headers.forEach((function(e){l[e.name]=e.value})),n.next=14,m({method:t.curRequest.method.toLowerCase(),url:(r||t.curRequest.host)+(t.curRequest.requestUrl||""),data:s,headers:l}).then((function(e){console.log(e),200===e.status&&(o?(t.leftData=o,t.rightData=e.data,t.finishCompare=!0,t.sending=!1,console.log("compare complete,preResponse:",o,",curResponse:",e.data)):t.compareHost&&""!==t.compareHost?(console.log("compare host",t.compareHost),t.sendAndCompare(e.data,t.compareHost)):(console.log("无compareHost"),t.finishCompare=!1,t.curResponseBody=e.data,t.sending=!1))})).catch((function(e){t.$notify.error({title:"发送请求错误",message:"url:"+(r||t.curRequest.host)+t.curRequest.requestUrl}),console.error(e),t.sending=!1}));case 14:case"end":return n.stop()}}),n)})))()},handleSelectionRequestsChange:function(e){this.selectedRequest=e},deleteRequest:function(){var e=this;this.selectedRequest&&this.selectedRequest.length&&(this.selectedRequest.forEach((function(t){e.allRequest.forEach((function(n){n.uuid===t.uuid&&e.allRequest.splice(e.allRequest.indexOf(n),1)}))})),this.filteredRequest=this.allRequest.filter((function(t){return t.url&&t.url.match(e.urlRegex)})),chrome.runtime.sendMessage({type:"setRequests",requests:this.allRequest},(function(e){})),this.$message({message:"删除成功",type:"success"}))},exportRequest:function(e){this.exportRequests(this.selectedRequest,e)},handleSelectionHeadersChange:function(e){this.headersSelected.value=e,console.log("handleSelectionHeadersChange",this.headersSelected)},formatDate:function(e){var t=e.getFullYear()+"-",n=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",o=(e.getDate()<10?"0"+e.getDate():e.getDate())+" ",r=(e.getHours()<10?"0"+e.getHours():e.getHours())+":",s=(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":",a=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return t+n+o+r+s+a},exportRequests:function(e,t){var n=e.length+"个webRequest导出-"+this.formatDate(new Date);switch(t){case"http":this.downloadFile(this.constructHttpFileContent(e),n+".http","utf-8");break;case"postman":this.downloadFile(this.constructPostmanExportContent(!1,e),n+".json","utf-8");break}},downloadFile:function(e,t,n){var o=document.createElement("a");o.setAttribute("href","data:text/plain;charset=".concat(n||"utf-8",",").concat(e)),o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)},constructHttpFileContent:function(e){return e.map((function(e){return"".concat(e.method.toUpperCase()," ").concat(e.url,"\n").concat(e.headers.map((function(e){return e.name+":"+e.value})).join("\n"),"\n\n").concat(e.requestBody)})).join("\n\n%23%23%23\n")},constructPostmanExportContent:function(e){var t={info:{schema:"https://schema.getpostman.com/json/collection/v2.0.0/collection.json"},item:[]};return e.forEach((function(e){t["item"].push({name:e.url,request:{url:e.url,method:e.method.toUpperCase(),header:e.headers.map((function(e){return{key:e.name,value:e.value,type:"text"}})),body:{mode:"raw",raw:e.requestBody}}})})),JSON.stringify(t)}}},g=f,v=n(3736),R=(0,v.Z)(g,r,s,!1,null,null,null),q=R.exports;o["default"].config.productionTip=!1,o["default"].use(p()),new o["default"]({render:function(e){return e(q)}}).$mount("#app")}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,s){if(!o){var a=1/0;for(u=0;u<e.length;u++){o=e[u][0],r=e[u][1],s=e[u][2];for(var l=!0,c=0;c<o.length;c++)(!1&s||a>=s)&&Object.keys(n.O).every((function(e){return n.O[e](o[c])}))?o.splice(c--,1):(l=!1,s<a&&(a=s));if(l){e.splice(u--,1);var i=r();void 0!==i&&(t=i)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[o,r,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,s,a=o[0],l=o[1],c=o[2],i=0;if(a.some((function(t){return 0!==e[t]}))){for(r in l)n.o(l,r)&&(n.m[r]=l[r]);if(c)var u=c(n)}for(t&&t(o);i<a.length;i++)s=a[i],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(u)},o=self["webpackChunkdiff_request"]=self["webpackChunkdiff_request"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(2205)}));o=n.O(o)})();
//# sourceMappingURL=app-legacy.18f0d28e.js.map